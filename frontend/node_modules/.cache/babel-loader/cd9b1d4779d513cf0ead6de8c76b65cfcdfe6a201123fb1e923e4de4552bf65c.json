{"ast":null,"code":"var _jsxFileName = \"/app/src/components/createorder/CreateOrder.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useContext } from \"react\";\nimport { createOrder } from \"../../api/orders\";\nimport { AuthContext } from \"../../App\";\nimport classes from \"./CreateOrder.module.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CreateOrder = () => {\n  _s();\n  const [ServicesData, setServicesData] = useState([]);\n  // const [Order, setOrder] = useState({});\n  const [Sum, setSum] = useState({});\n  const [Note, SetNote] = useState(\"\");\n  const {\n    isAuthenticated\n  } = useContext(AuthContext);\n  useEffect(() => {\n    fetch(\"/api/servicesdata\", {\n      method: \"GET\"\n    }).then(response => response.json()).then(data => {\n      setServicesData(data);\n    }).catch(error => console.log(error));\n  }, []);\n\n  //  function changeCount(event) {\n  //     setOrder(Order => ({...Order, [event.target.id]: event.target.value}))\n\n  //     setSum(Sum => ({...Sum,[event.target.id]: event.target.value * event.target.name}))\n  //  }\n\n  const changeCount = useCallback((e, id, type, superType, cost) => {\n    setServicesData(ServicesData => ServicesData.map(Super => {\n      if (Super.super_type_id === superType) {\n        Super.data.map(Type => {\n          if (Type.type_id === type) {\n            Type.data.map(s => {\n              if (s.id === id) s.count = e.target.value;\n              return s;\n            });\n          }\n          return type;\n        });\n      }\n      return Super;\n    }));\n    setSum(Sum => ({\n      ...Sum,\n      [id]: e.target.value * cost\n    }));\n  }, []);\n  const SendOrder = e => {\n    e.preventDefault();\n    if (isAuthenticated) {\n      createOrder(localStorage.getItem(\"token\"), new Date(), Note, ServicesData);\n    }\n  };\n  function CalcSum() {\n    let summa = 0;\n    for (const [key, value] of Object.entries(Sum)) {\n      summa += value;\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: summa\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.wrap,\n    id: \"createorder\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.wraporder,\n      children: ServicesData.map(superType => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.wrapsupertype,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: superType[\"super_type\"]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this), superType[\"data\"].map(type => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.wraptype,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: type[\"type\"]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 17\n          }, this), type[\"data\"].map(service => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.wrapservice,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: service[\"name\"]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: service[\"cost\"]\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 90,\n                columnNumber: 26\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classes.annotation,\n                children: \"\\u0440\\u0443\\u0431.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 90,\n                columnNumber: 54\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: classes.count,\n                type: \"text\",\n                value: service.count,\n                onChange: e => changeCount(e, service.id, type.type_id, superType.super_type_id, service.cost),\n                placeholder: \"0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 91,\n                columnNumber: 26\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 21\n            }, this)]\n          }, service[\"id\"], true, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 19\n          }, this))]\n        }, type[\"type_id\"], true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 15\n        }, this))]\n      }, superType[\"super_type_id\"], true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.wrapsum,\n      children: [\"\\u041F\\u0440\\u0435\\u0434\\u0432\\u0430\\u0440\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u0430\\u044F \\u0441\\u0442\\u043E\\u0438\\u043C\\u043E\\u0441\\u0442\\u044C:\", \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.sum,\n        children: /*#__PURE__*/_jsxDEV(CalcSum, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      type: \"text\",\n      placeholder: \"\\u041F\\u0440\\u0438\\u043C\\u0435\\u0447\\u0430\\u043D\\u0438\\u044F\",\n      value: Note,\n      onChange: e => SetNote(e.target.value),\n      className: classes.note\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: classes.btn,\n      onClick: SendOrder,\n      children: \"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n_s(CreateOrder, \"qH4yyNDvu1DYmPHaoB7U4vyDNsQ=\");\n_c = CreateOrder;\nexport default CreateOrder;\nvar _c;\n$RefreshReg$(_c, \"CreateOrder\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useContext","createOrder","AuthContext","classes","jsxDEV","_jsxDEV","CreateOrder","_s","ServicesData","setServicesData","Sum","setSum","Note","SetNote","isAuthenticated","fetch","method","then","response","json","data","catch","error","console","log","changeCount","e","id","type","superType","cost","map","Super","super_type_id","Type","type_id","s","count","target","value","SendOrder","preventDefault","localStorage","getItem","Date","CalcSum","summa","key","Object","entries","children","fileName","_jsxFileName","lineNumber","columnNumber","className","wrap","wraporder","wrapsupertype","wraptype","service","wrapservice","annotation","onChange","placeholder","wrapsum","sum","note","btn","onClick","_c","$RefreshReg$"],"sources":["/app/src/components/createorder/CreateOrder.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useContext } from \"react\";\nimport { createOrder } from \"../../api/orders\";\nimport { AuthContext } from \"../../App\";\nimport classes from \"./CreateOrder.module.css\";\n\nconst CreateOrder = () => {\n  const [ServicesData, setServicesData] = useState([]);\n  // const [Order, setOrder] = useState({});\n  const [Sum, setSum] = useState({});\n  const [Note, SetNote] = useState(\"\");\n  const { isAuthenticated } = useContext(AuthContext);\n\n  useEffect(() => {\n    fetch(\"/api/servicesdata\", {\n      method: \"GET\",\n    })\n      .then((response) => response.json())\n      .then((data) => {\n        setServicesData(data);\n      })\n      .catch((error) => console.log(error));\n  }, []);\n\n  //  function changeCount(event) {\n  //     setOrder(Order => ({...Order, [event.target.id]: event.target.value}))\n\n  //     setSum(Sum => ({...Sum,[event.target.id]: event.target.value * event.target.name}))\n  //  }\n\n  const changeCount = useCallback((e, id, type, superType, cost) => {\n    setServicesData((ServicesData) =>\n      ServicesData.map((Super) => {\n        if (Super.super_type_id === superType) {\n          Super.data.map((Type) => {\n            if (Type.type_id === type) {\n              Type.data.map((s) => {\n                if (s.id === id) s.count = e.target.value;\n                return s;\n              });\n            }\n            return type;\n          });\n        }\n        return Super;\n      })\n    );\n    setSum((Sum) => ({ ...Sum, [id]: e.target.value * cost }));\n  }, []);\n\n  const SendOrder = (e) => {\n    e.preventDefault();\n    if (isAuthenticated) {\n      createOrder(\n        localStorage.getItem(\"token\"),\n        new Date(),\n        Note,\n        ServicesData\n      );\n    }\n  };\n\n  function CalcSum() {\n    let summa = 0;\n    for (const [key, value] of Object.entries(Sum)) {\n      summa += value;\n    }\n\n    return <div>{summa}</div>;\n  }\n\n  return (\n    <div className={classes.wrap} id=\"createorder\">\n      <div className={classes.wraporder}>\n        {ServicesData.map((superType) => (\n          <div\n            key={superType[\"super_type_id\"]}\n            className={classes.wrapsupertype}\n          >\n            <div>{superType[\"super_type\"]}</div>\n\n            {/* <div> */}\n            {superType[\"data\"].map((type) => (\n              <div key={type[\"type_id\"]} className={classes.wraptype}>\n                <div>{type[\"type\"]}</div>\n\n                {/* <div> */}\n                {type[\"data\"].map((service) => (\n                  <div key={service[\"id\"]} className={classes.wrapservice}>\n                    <div>{service[\"name\"]}</div>\n                    <div><div>{service[\"cost\"]}</div><div className={classes.annotation}>руб.</div></div>\n                    <div><input\n                      className={classes.count}\n                      type=\"text\"\n                      value={service.count}\n                      onChange={(e) =>\n                        changeCount(\n                          e,\n                          service.id,\n                          type.type_id,\n                          superType.super_type_id,\n                          service.cost\n                        )\n                      }\n                      placeholder=\"0\"\n                    ></input></div>\n                  </div>\n                ))}\n                {/* </div> */}\n              </div>\n            ))}\n            {/* </div> */}\n          </div>\n        ))}\n      </div>\n      <div className={classes.wrapsum}>\n        Предварительная стоимость:{\" \"}\n        <div className={classes.sum}>\n          <CalcSum />\n        </div>\n      </div>\n      <textarea\n        type=\"text\"\n        placeholder=\"Примечания\"\n        value={Note}\n        onChange={(e) => SetNote(e.target.value)}\n        className={classes.note}\n      ></textarea>\n      <button className={classes.btn} onClick={SendOrder}>\n        Сделать заказ\n      </button>\n    </div>\n  );\n};\nexport default CreateOrder;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}